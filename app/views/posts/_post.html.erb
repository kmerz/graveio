<% if post.title.present? %>
  <h3><%= link_to post.title, post %></h3>
<% else %>
  <span>&nbsp;</span>
<% end %>
  <%=
    options = { options: {encoding: 'utf-8'} }
    if Pygments::Lexer.find(post.content_type)
      options.merge!(lexer: post.content_type.downcase)
    end
    Pygments.highlight(
      truncate(post.content, :length => 800, :omission => "\n\n..."),
      options).html_safe %>
<% if post.author.present? %>
  <small class="author">- <%= post.author %></small>
<% else %>
  <small class="author">- Anonymous</small>
<% end %>
<small class="content_type"> (<%= post.content_type %>)</small>
<% if post.all_comments.present? %>
  <span class="comments_count">
    <%= post.all_comments.size %>
    <i class="icon-comment"></i>
  </span>
<% end %>
<div class="pull-right">
  <div class="btn-group">
    <%= link_to post, :class => "btn btn-small" do %>
      <i class="icon-eye-open"></i>
    <% end %>
    <%= link_to post_path(post, :format => :text),
      :class => "btn btn-small"  do %>
      <i class="icon-download"></i>
    <% end%>
    <%= link_to edit_post_path(post), :class => "btn btn-small"  do %>
      <i class="icon-edit"></i>
      <% end %>
    <%= link_to post, method: :delete,
     data: { confirm: 'Are you sure?' }, :class => "btn btn-small" do %>
      <i class="icon-trash"></i>
    <% end %>
    <%= link_to like_post_path(post), :class => "btn btn-small" do %>
      <i class="icon-thumbs-up"></i>
      <%= post.likedislikes.find_all_by_liked(true).size %>
    <% end %>
    <%= link_to dislike_post_path(post), :class => "btn btn-small"  do %>
      <i class="icon-thumbs-down"></i>
      <%= post.likedislikes.find_all_by_liked(false).size %>
    <% end %>
  </div>
</div>
<br />
<br />
